

--- FILE: ./main.tsx ---

import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.tsx'

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>,
)


--- FILE: ./api/axiosClient.ts ---

import axios from "axios";

const axiosClient = axios.create({
  baseURL: import.meta.env.VITE_API_URL || "/api-v1/api/halaqah", //|| "https://halaqahid-backend.vercel.app/api/halaqah",
  headers: {
    "Content-Type": "application/json",
  },
});

// 1. REQUEST INTERCEPTOR: Mengirim Token di setiap request
axiosClient.interceptors.request.use((config) => {
  const savedData = localStorage.getItem("user");
  if (savedData) {
    try {
      const { token } = JSON.parse(savedData);
      if (token) {
        config.headers.Authorization = `Bearer ${token}`;
      }
    } catch (e) {
      console.error("Gagal parse data user dari localStorage", e);
    }
  }
  return config;
});

// 2. RESPONSE INTERCEPTOR: Menangkap kalau token mati (Anti-Jebol)
axiosClient.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      localStorage.removeItem("user");
      window.location.href = "/login";
    }
    return Promise.reject(error);
  }
);

export default axiosClient;

--- FILE: ./components/shared/Sidebar.tsx ---

import { useAuth } from "@/context/AuthContext";
import { Link, useLocation } from "react-router-dom";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faChartPie, 
  faUsers, 
  faBook, 
  faClipboardCheck, 
  faUserTie,
  faSignOutAlt,
  faBookOpen,
  faTimes
} from "@fortawesome/free-solid-svg-icons";
import { cn } from "@/lib/utils";

export function Sidebar({ onClose }: { onClose?: () => void }) {
  const { user, logout } = useAuth();
  const location = useLocation();

  // Definisi Menu berdasarkan Role (Sesuai Flowchart)
  const menuItems = user?.role === "superadmin" 
    ? [
        { name: "Dashboard", path: "/kepala-muhafidz", icon: faChartPie },
        { name: "Kelola Musyrif", path: "/kepala-muhafidz/musyrif", icon: faUserTie },
        { name: "Kelola Halaqah", path: "/kepala-muhafidz/halaqah", icon: faBook },
        { name: "Lihat Laporan", path: "/kepala-muhafidz/laporan", icon: faClipboardCheck },
      ]
    : [
        { name: "Absensi Hari Ini", path: "/muhafidz", icon: faClipboardCheck },
        { name: "Input Setoran", path: "/muhafidz/setoran", icon: faBookOpen },
        { name: "Kelola Santri", path: "/muhafidz/santri", icon: faUsers },
        { name: "Progres Santri", path: "/muhafidz/progres", icon: faChartPie },
      ];

  return (
    <aside className="flex h-screen w-64 flex-col border-r border-border bg-surface-light dark:bg-surface-dark transition-colors duration-300">
      {/* Logo Section */}
      <div className="flex h-20 items-center justify-between px-6"> 
        <div className="flex items-center gap-3">
          <div className="flex h-9 w-9 items-center justify-center rounded-lg bg-primary text-white shadow-lg shadow-primary/20">
            <FontAwesomeIcon icon={faBookOpen} />
          </div>
          <span className="text-xl font-bold tracking-tight dark:text-white font-display">HalaqahId</span>
        </div>
        
        {/* Tombol Close - Hanya muncul di mobile */}
        <button onClick={onClose} className="lg:hidden text-text-secondary dark:text-white">
          <FontAwesomeIcon icon={faTimes} />
        </button>
      </div>

      {/* Navigation */}
      <nav className="flex-1 space-y-1 px-3 py-4">
        {menuItems.map((item) => {
          const isActive = location.pathname === item.path;
          return (
            <Link
              key={item.name}
              to={item.path}
              onClick={onClose} // Tutup sidebar setelah klik link di mobile
              className={cn(
                "flex items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium transition-all duration-200",
                isActive 
                  ? "bg-primary/10 text-primary dark:bg-primary/20" 
                  : "text-text-secondary hover:bg-accent/50 dark:text-text-secondary-dark dark:hover:bg-accent/10"
              )}
            >
              <FontAwesomeIcon icon={item.icon} className={cn("w-5", isActive ? "text-primary" : "opacity-70")} />
              {item.name}
            </Link>
          );
        })}
      </nav>

      {/* Logout Button */}
      <div className="border-t border-border p-4">
        <button
          onClick={logout}
          className="flex w-full items-center gap-3 rounded-lg px-3 py-2.5 text-sm font-medium text-destructive hover:bg-destructive/10 transition-colors"
        >
          <FontAwesomeIcon icon={faSignOutAlt} />
          Keluar
        </button>
      </div>
    </aside>
  );
}

--- FILE: ./components/forms/LoginForm.tsx ---

import { useState } from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { useNavigate } from "react-router-dom";
import { loginSchema, type LoginFormValues } from "@/utils/zodSchema";
import { useAuth } from "@/context/AuthContext";

// Import Shadcn UI
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form";

// Import FontAwesome
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { 
  faEnvelope, 
  faLock, 
  faArrowRight, 
  faEye, 
  faEyeSlash 
} from "@fortawesome/free-solid-svg-icons";

export function LoginForm() {
  const [showPassword, setShowPassword] = useState(false);
  const { login, isLoading } = useAuth();
  const navigate = useNavigate();

  const form = useForm<LoginFormValues>({
    resolver: zodResolver(loginSchema),
    defaultValues: {
      email: "",
      password: "",
    },
  });

async function onSubmit(values: LoginFormValues) {
  try {
    await login(values);
    navigate("/");
  } catch (error: any) {
    // Tangkap pesan error dari backend
    console.error("Full Error Object:", error);
    console.log("Status Code:", error.response?.status);
    console.log("Response Data:", error.response?.data);
    const message = error.response?.data?.message || "Terjadi kesalahan koneksi";
    
    // Set error ke field password agar muncul di FormMessage
    form.setError("password", { 
      type: "manual", 
      message: message 
    });
  }
}

  return (
    <Form {...form}>
      <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-5">
        
        {/* Email Field */}
        <FormField
          control={form.control}
          name="email"
          render={({ field }) => (
            <FormItem className="space-y-2">
              <FormLabel className="text-sm font-medium dark:text-white">
                Email Address
              </FormLabel>
              <FormControl>
                <div className="relative">
                  <span className="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary-light dark:text-gray-400">
                    <FontAwesomeIcon icon={faEnvelope} className="text-[18px]" />
                  </span>
                  <Input
                    {...field}
                    type="email"
                    placeholder="ustadz@example.com"
                    disabled={isLoading}
                    className="h-12 pl-10 border-[#d6e7d0] dark:border-gray-600 bg-background-light dark:bg-surface-dark focus:ring-2 focus:ring-primary transition-all"
                  />
                </div>
              </FormControl>
              <FormMessage className="text-xs" />
            </FormItem>
          )}
        />

        {/* Password Field */}
        <FormField
          control={form.control}
          name="password"
          render={({ field }) => (
            <FormItem className="space-y-2">
              <div className="flex items-center justify-between">
                <FormLabel className="text-sm font-medium dark:text-white">
                  Password
                </FormLabel>
                <a
                  href="#"
                  className="text-xs font-medium text-primary hover:text-primary-dark hover:underline"
                >
                  Forgot Password?
                </a>
              </div>
              <FormControl>
                <div className="relative">
                  <span className="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary-light dark:text-gray-400">
                    <FontAwesomeIcon icon={faLock} className="text-[18px]" />
                  </span>
                  <Input
                    {...field}
                    type={showPassword ? "text" : "password"}
                    placeholder="Masukkan password"
                    disabled={isLoading}
                    className="h-12 pl-10 pr-10 border-[#d6e7d0] dark:border-gray-600 bg-background-light dark:bg-surface-dark focus:ring-2 focus:ring-primary transition-all"
                  />
                  <button
                    type="button"
                    onClick={() => setShowPassword(!showPassword)}
                    className="absolute right-3 top-1/2 -translate-y-1/2 text-text-secondary-light hover:text-primary transition-colors"
                  >
                    <FontAwesomeIcon icon={showPassword ? faEyeSlash : faEye} className="text-[18px]" />
                  </button>
                </div>
              </FormControl>
              <FormMessage className="text-xs" />
            </FormItem>
          )}
        />

        {/* Submit Button */}
        <Button
          type="submit"
          disabled={isLoading}
          className="w-full h-12 bg-primary hover:bg-primary-dark text-white font-semibold shadow-lg shadow-primary/20"
        >
          {isLoading ? (
            <span className="flex items-center gap-2">
              <svg className="animate-spin h-4 w-4 text-white" viewBox="0 0 24 24">
                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" fill="none" />
                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
              </svg>
              Mohon tunggu...
            </span>
          ) : (
            <span className="flex items-center gap-2">
              Sign In
              <FontAwesomeIcon icon={faArrowRight} className="text-sm" />
            </span>
          )}
        </Button>
      </form>
    </Form>
  );
}

--- FILE: ./components/ui/button.tsx ---

import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
        "icon-sm": "size-8",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      data-variant={variant}
      data-size={size}
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }


--- FILE: ./components/ui/form.tsx ---

"use client"

import * as React from "react"
import type * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  FormProvider,
  useFormContext,
  useFormState,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState } = useFormContext()
  const formState = useFormState({ name: fieldContext.name })
  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

function FormItem({ className, ...props }: React.ComponentProps<"div">) {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div
        data-slot="form-item"
        className={cn("grid gap-2", className)}
        {...props}
      />
    </FormItemContext.Provider>
  )
}

function FormLabel({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  const { error, formItemId } = useFormField()

  return (
    <Label
      data-slot="form-label"
      data-error={!!error}
      className={cn("data-[error=true]:text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      data-slot="form-control"
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
}

function FormDescription({ className, ...props }: React.ComponentProps<"p">) {
  const { formDescriptionId } = useFormField()

  return (
    <p
      data-slot="form-description"
      id={formDescriptionId}
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function FormMessage({ className, ...props }: React.ComponentProps<"p">) {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message ?? "") : props.children

  if (!body) {
    return null
  }

  return (
    <p
      data-slot="form-message"
      id={formMessageId}
      className={cn("text-destructive text-sm", className)}
      {...props}
    >
      {body}
    </p>
  )
}

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}


--- FILE: ./components/ui/label.tsx ---

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "@/lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }


--- FILE: ./components/ui/input.tsx ---

import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        `
        h-9 w-full min-w-0 rounded-md border
        bg-[var(--input)]
        text-[var(--foreground)]
        border-[var(--border)]
        px-3 py-1 text-base shadow-xs
        transition-[color,box-shadow]
        outline-none

        placeholder:text-[var(--muted)]
        selection:bg-primary
        selection:text-primary-foreground

        focus-visible:border-ring
        focus-visible:ring-ring/50
        focus-visible:ring-[3px]

        disabled:pointer-events-none
        disabled:cursor-not-allowed
        disabled:opacity-50

        file:inline-flex
        file:h-7
        file:border-0
        file:bg-transparent
        file:text-sm
        file:font-medium
        `,
        className
      )}
      {...props}
    />
  )
}

export { Input }


--- FILE: ./components/ThemeToggle.tsx ---

import { useAuth } from "@/context/AuthContext";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faSun, faMoon } from "@fortawesome/free-solid-svg-icons";

// 1. Tambahkan interface untuk mendefinisikan props
interface ThemeToggleProps {
  variant?: "simple" | "default"; // "?" berarti opsional
}

// 2. Terima props di fungsi
export function ThemeToggle({ variant = "default" }: ThemeToggleProps) {
  const { isDarkMode, toggleDarkMode } = useAuth();

  // 3. Logika untuk varian "simple"
  if (variant === "simple") {
    return (
      <button onClick={toggleDarkMode} className="p-2">
        <FontAwesomeIcon 
          icon={isDarkMode ? faSun : faMoon} 
          className={isDarkMode ? 'text-yellow-500' : 'text-gray-500'}
        />
      </button>
    );
  }

  // Tampilan default (kode asli kamu)
  return (
    <button
      onClick={toggleDarkMode}
      type="button"
      className="relative inline-flex items-center justify-center w-12 h-6 rounded-full transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 bg-gray-200 dark:bg-gray-700"
      aria-label={`Switch to ${isDarkMode ? 'light' : 'dark'} mode`}
    >
      <div className="absolute inset-0 rounded-full bg-gradient-to-r from-blue-100 to-yellow-100 dark:from-gray-800 dark:to-purple-800 opacity-60" />
      
      <div
        className={`absolute left-1 top-1 w-4 h-4 rounded-full bg-white shadow-lg transform transition-transform duration-300 ${
          isDarkMode ? 'translate-x-6' : 'translate-x-0'
        }`}
      >
        <div className="flex items-center justify-center h-full">
          <FontAwesomeIcon 
            icon={isDarkMode ? faSun : faMoon} 
            className={`text-[10px] ${
              isDarkMode ? 'text-yellow-500' : 'text-indigo-600'
            }`}
          />
        </div>
      </div>
      
      <div className="flex items-center justify-between w-full px-1.5">
        <FontAwesomeIcon icon={faSun} className="text-[10px] text-yellow-500 opacity-80" />
        <FontAwesomeIcon icon={faMoon} className="text-[10px] text-indigo-400 opacity-80" />
      </div>
    </button>
  );
}

--- FILE: ./layouts/DashboardLayout.tsx ---

import { useState } from "react";
import { Sidebar } from "@/components/shared/Sidebar";
import { ThemeToggle } from "@/components/ThemeToggle";
import { useAuth } from "@/context/AuthContext";
import { Outlet } from "react-router-dom"; 
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBars, faTimes } from "@fortawesome/free-solid-svg-icons";
import { cn } from "@/lib/utils";

export default function DashboardLayout() {
  const { user } = useAuth();
  const [isSidebarOpen, setIsSidebarOpen] = useState(false);

  const toggleSidebar = () => setIsSidebarOpen(!isSidebarOpen);

  return (
    <div className="flex min-h-screen bg-background dark:bg-background-dark font-display relative">
      
      {/* Sidebar - Desktop & Mobile */}
      {/* Overlay untuk mobile saat sidebar terbuka */}
      {isSidebarOpen && (
        <div 
          className="fixed inset-0 z-40 bg-black/50 lg:hidden transition-opacity"
          onClick={() => setIsSidebarOpen(false)}
        />
      )}

      <div className={cn(
        "fixed inset-y-0 left-0 z-50 transform lg:relative lg:translate-x-0 transition duration-300 ease-in-out lg:block",
        isSidebarOpen ? "translate-x-0" : "-translate-x-full"
      )}>
        <Sidebar onClose={() => setIsSidebarOpen(false)} />
      </div>

      <div className="flex flex-1 flex-col min-w-0 overflow-hidden">
        {/* Top Navbar */}
        <header className="
            fixed top-0 left-0 right-0 z-40
            lg:static
            flex h-16 items-center justify-between
            border-b border-border
            bg-surface-light px-4 lg:px-8
            dark:bg-surface-dark
          "> 

          <div className="flex items-center gap-4">
            {/* Hamburger Button - Hanya muncul di mobile */}
            <button 
              onClick={toggleSidebar}
              className="flex h-10 w-10 items-center justify-center rounded-lg border border-border lg:hidden dark:text-white"
            >
              <FontAwesomeIcon icon={isSidebarOpen ? faTimes : faBars} />
            </button>

            <div className="flex flex-col text-left">
              <h1 className="text-sm font-semibold dark:text-white leading-tight">Selamat Datang,</h1>
              <p className="text-xs text-text-secondary dark:text-text-secondary-dark">{user?.nama}</p>
            </div>
          </div>

          <div className="flex items-center gap-4">
            <ThemeToggle variant="simple" />
            <div className="h-8 w-8 rounded-full bg-primary/20 border border-primary/50 flex items-center justify-center text-primary font-bold text-xs uppercase">
              {user?.nama?.substring(0, 2)}
            </div>
          </div>
        </header>

        {/* Dynamic Page Content */}
        <main className="flex-1 overflow-y-auto p-4 lg:p-8 pt-20 lg:pt-4 text-left">
          <div className="mx-auto max-w-7xl">
            <Outlet /> 
          </div>
        </main>
      </div>
    </div>
  );
}

--- FILE: ./pages/muhafidz/Absensi.tsx ---

import { useState } from "react";
type Status = "hadir" | "absen" | "izin";

interface AbsensiRow {
  santriId: number;
  namaSantri: string;
  status: Status;
  keterangan?: string;
}

export default function AbsensiPage() {
  const [rows, setRows] = useState<AbsensiRow[]>([
    { santriId: 1, namaSantri: "Ahmad", status: "hadir" },
    { santriId: 2, namaSantri: "Fahri", status: "absen" },
    { santriId: 3, namaSantri: "Zaid", status: "izin", keterangan: "Sakit" },
  ]);

  const handleStatusChange = (index: number, status: Status) => {
    const updated = [...rows];
    updated[index].status = status;
    if (status !== "izin") updated[index].keterangan = undefined;
    setRows(updated);
  };

  const handleKeteranganChange = (index: number, value: string) => {
    const updated = [...rows];
    updated[index].keterangan = value;
    setRows(updated);
  };

  const handleSubmit = () => {
    const invalidIzin = rows.find(
      (row) => row.status === "izin" && (!row.keterangan || row.keterangan.trim() === "")
    );

    if (invalidIzin) {
      alert("Gagal menyimpan!\nSantri dengan status IZIN wajib mengisi keterangan.");
      return;
    }

    console.log("Saving absensi...", rows);
    alert("Absensi hari ini berhasil disimpan");
  };

  return (
    <div className="space-y-6 animate-in fade-in duration-500">
      <header className="flex flex-col text-left">
        <h2 className="text-2xl font-bold text-foreground dark:text-foreground-dark">
          Absensi Hari Ini
        </h2>
        <p className="text-muted-foreground dark:text-text-secondary-dark text-sm">
          {new Date().toLocaleDateString("id-ID", {
            day: "2-digit",
            month: "long",
            year: "numeric",
          })}
        </p>
      </header>

      <div className="overflow-hidden rounded-xl border border-border dark:border-border-dark bg-card dark:bg-surface-dark shadow-sm">
        <div className="overflow-x-auto">
          <table className="w-full text-sm text-left">
            <thead className="bg-accent/50 dark:bg-background-dark/50 text-foreground dark:text-foreground-dark">
              <tr>
                <th className="px-6 py-4 font-semibold">Nama Santri</th>
                <th className="px-6 py-4 font-semibold">Status</th>
                <th className="px-6 py-4 font-semibold">Keterangan</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-border dark:divide-border-dark">
              {rows.map((row, index) => (
                <tr key={row.santriId} className="hover:bg-accent/5 dark:hover:bg-accent/5 transition-colors">
                  <td className="px-6 py-4 font-medium dark:text-foreground-dark">
                    {row.namaSantri}
                  </td>
                  <td className="px-6 py-4">
                    <select
                      value={row.status}
                      onChange={(e) => handleStatusChange(index, e.target.value as Status)}
                      className="bg-background dark:bg-background-dark text-foreground dark:text-foreground-dark border border-border dark:border-border-dark rounded-md px-3 py-1.5 focus:ring-2 focus:ring-primary outline-none"
                    >
                      <option value="hadir">Hadir</option>
                      <option value="absen">Absen</option>
                      <option value="izin">Izin</option>
                    </select>
                  </td>
                  <td className="px-6 py-4">
                    {row.status === "izin" ? (
                      <input
                        type="text"
                        value={row.keterangan || ""}
                        onChange={(e) => handleKeteranganChange(index, e.target.value)}
                        placeholder="Alasan izin..."
                        className="w-full max-w-xs rounded-md border border-border dark:border-border-dark bg-background dark:bg-background-dark px-3 py-1.5 text-foreground dark:text-foreground-dark placeholder:text-muted focus:ring-2 focus:ring-primary outline-none"
                      />
                    ) : (
                      <span className="text-muted italic text-xs">N/A</span>
                    )}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      <div className="flex justify-end">
        <button
          onClick={handleSubmit}
          className="bg-primary hover:bg-primary-dark text-white px-8 py-2.5 rounded-lg font-bold transition-all shadow-md active:scale-95"
        >
          Simpan Absensi
        </button>
      </div>
    </div>
  );
}

--- FILE: ./pages/muhafidz/KelolaSantri.tsx ---



--- FILE: ./pages/muhafidz/ProgresSantri.tsx ---



--- FILE: ./pages/muhafidz/index.tsx ---

import { Routes, Route, Navigate } from "react-router-dom";
import SetoranPage from "./Setoran";
import AbsensiPage from "./Absensi"; // Kita akan buat file ini

export default function MuhafidzPage() {
  return (
    <Routes>
      {/* Default redirect ke absensi atau setoran */}
      <Route index element={<AbsensiPage />} />
      
      <Route path="/setoran" element={<SetoranPage />} />
      
      {/* Halaman Form Setoran spesifik santri */}
      <Route path="setoran/:santriId" element={<div>Halaman Form Setoran (Coming Soon)</div>} />
      
      {/* Halaman Riwayat */}
      <Route path="riwayat" element={<div>Halaman Riwayat (Coming Soon)</div>} />

      {/* Fallback */}
      <Route path="*" element={<Navigate to="." replace />} />
    </Routes>
  );
}

--- FILE: ./pages/muhafidz/Setoran.tsx ---

import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { setoranSchema, type SetoranFormValues } from "@/utils/zodSchema";

// UI Components (Shadcn)
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form";

// Mock Data
const MOCK_SANTRI = [
  { id: 1, nama: "Ahmad" },
  { id: 2, nama: "Zaid Ramadhan" },
  { id: 3, nama: "Umar Mukhtar" },
];

const MOCK_HISTORY = [
  { id: 101, nama: "Ahmad", surah: "Al-Baqarah", ayat: "1-10", nilai: 90, waktu: "08:30" },
  { id: 102, nama: "Zaid Ramadhan", surah: "An-Naba", ayat: "1-40", nilai: 85, waktu: "09:15" },
];

export default function InputSetoranPage() {
    const form = useForm<SetoranFormValues>({
    // Gunakan casting 'as any' pada zodResolver jika versi library bentrok
    resolver: zodResolver(setoranSchema) as any, 
    defaultValues: {
        santri_id: 0,
        surah: "",
        ayat_mulai: 1,
        ayat_selesai: 1,
        nilai: 80,
        catatan: "ulang",
        tanggal: new Date(),
    },
    });

  function onSubmit(data: SetoranFormValues) {
    console.log("Submit Data:", data);
    alert("Setoran Berhasil Disimpan!");
    form.reset({
      ...form.getValues(),
      surah: "",
      ayat_mulai: 1,
      ayat_selesai: 1,
    });
  }

  return (
    <div className="space-y-6">
      <div className="flex flex-col text-left">
        <h2 className="text-2xl font-bold tracking-tight text-foreground dark:text-foreground-dark">
          Input Setoran Hafalan
        </h2>
        <p className="text-muted-foreground dark:text-text-secondary-dark">
          Silahkan pilih santri dan masukkan detail hafalan.
        </p>
      </div>

      {/* Card Wrapper */}
      <div className="rounded-xl border border-border dark:border-border-dark bg-card dark:bg-surface-dark p-6 shadow-sm transition-colors">
        <Form {...form}>
          <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-6">
            
            {/* Pilih Santri */}
            <FormField
              control={form.control}
              name="santri_id"
              render={({ field }) => (
                <FormItem className="text-left">
                  <FormLabel className="dark:text-foreground-dark">Santri</FormLabel>
                  <FormControl>
                    <select
                      {...field}
                      value={field.value}
                      onChange={(e) => field.onChange(e.target.value)}
                      className="flex h-10 w-full rounded-md border border-input dark:border-border-dark bg-background dark:bg-background-dark px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring dark:text-foreground-dark"
                    >
                      <option value={0} disabled>-- Pilih Nama Santri --</option>
                      {MOCK_SANTRI.map((s) => (
                        <option key={s.id} value={s.id}>{s.nama}</option>
                      ))}
                    </select>
                  </FormControl>
                  <FormMessage className="text-destructive dark:text-red-400" />
                </FormItem>
              )}
            />

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 text-left">
              {/* Surah */}
              <FormField
                control={form.control}
                name="surah"
                render={({ field }) => (
                  <FormItem className="md:col-span-2">
                    <FormLabel className="dark:text-foreground-dark">Nama Surah</FormLabel>
                    <FormControl>
                      <Input 
                        placeholder="Contoh: Al-Baqarah" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark dark:text-foreground-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Ayat Mulai */}
              <FormField
                control={form.control}
                name="ayat_mulai"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Ayat Mulai</FormLabel>
                    <FormControl>
                      <Input 
                        type="number" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Ayat Selesai */}
              <FormField
                control={form.control}
                name="ayat_selesai"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Ayat Selesai</FormLabel>
                    <FormControl>
                      <Input 
                        type="number" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Nilai */}
              <FormField
                control={form.control}
                name="nilai"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Nilai</FormLabel>
                    <FormControl>
                      <Input 
                        type="number" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />

              {/* Catatan */}
              <FormField
                control={form.control}
                name="catatan"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel className="dark:text-foreground-dark">Catatan</FormLabel>
                    <FormControl>
                      <Input 
                        placeholder="Tambahkan catatan jika ada" 
                        {...field} 
                        className="dark:bg-background-dark dark:border-border-dark"
                      />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
            </div>

            <div className="flex justify-end pt-4">
              <Button 
                type="submit" 
                className="w-full md:w-auto bg-primary hover:bg-primary-dark text-primary-foreground px-10"
              >
                Simpan Setoran
              </Button>
            </div>
          </form>
        </Form>
      </div>

      {/* Tabel Riwayat Hari Ini */}
      <div className="space-y-4">
        <div className="flex items-center justify-between">
          <h3 className="text-lg font-semibold dark:text-foreground-dark">Riwayat Setoran Hari Ini</h3>
          <span className="text-xs text-muted-foreground bg-accent/50 dark:bg-surface-dark px-2 py-1 rounded-full border border-border dark:border-border-dark">
            {new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' })}
          </span>
        </div>

        <div className="rounded-xl border border-border dark:border-border-dark bg-card dark:bg-surface-dark overflow-hidden shadow-sm">
          <div className="overflow-x-auto">
            <table className="w-full text-left text-sm">
              <thead className="bg-accent/30 dark:bg-background-dark/50 text-muted-foreground font-medium border-b border-border dark:border-border-dark">
                <tr>
                  <th className="px-6 py-3">Nama Santri</th>
                  <th className="px-6 py-3">Surah</th>
                  <th className="px-6 py-3 text-center">Ayat</th>
                  <th className="px-6 py-3 text-center">Nilai</th>
                  <th className="px-6 py-3 text-right">Waktu</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-border dark:divide-border-dark">
                {MOCK_HISTORY.map((item) => (
                  <tr key={item.id} className="hover:bg-accent/10 dark:hover:bg-background-dark/30 transition-colors">
                    <td className="px-6 py-4 font-medium dark:text-foreground-dark">{item.nama}</td>
                    <td className="px-6 py-4 dark:text-text-secondary-dark">{item.surah}</td>
                    <td className="px-6 py-4 text-center dark:text-text-secondary-dark">{item.ayat}</td>
                    <td className="px-6 py-4 text-center">
                      <span className="inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary border border-primary/20">
                        {item.nilai}
                      </span>
                    </td>
                    <td className="px-6 py-4 text-right text-muted-foreground">{item.waktu}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
          
          {MOCK_HISTORY.length === 0 && (
            <div className="py-10 text-center text-muted-foreground">
              Belum ada setoran masuk hari ini.
            </div>
          )}
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/auth/LoginPage.tsx ---

import { LoginForm } from "@/components/forms/LoginForm";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBookOpen } from "@fortawesome/free-solid-svg-icons";
import loginBg from "@/assets/login-bg.png"; 
import { ThemeToggle } from "@/components/ThemeToggle";

export default function LoginPage() {
  return (
    <div className="flex min-h-screen w-full overflow-hidden bg-background-light dark:bg-background-dark">

      <div className="absolute top-4 right-4 z-50">
        <ThemeToggle variant="simple"/>
      </div>
      
      {/* --- Bagian Kiri: Branding & Image (Hanya muncul di Desktop) --- */}
      <div className="relative hidden w-1/2 flex-col justify-between overflow-hidden bg-surface-dark lg:flex">
        {/* Background Image dengan Overlay */}
        <div 
          className="absolute inset-0 h-full w-full bg-cover bg-center opacity-60 transition-transform duration-1000 hover:scale-105"
          style={{ backgroundImage: `url(${loginBg})` }}
        />
        
        {/* Gradient Overlay untuk keterbacaan teks */}
        <div className="absolute inset-0 bg-gradient-to-b from-background-dark/30 to-background-dark/90" />

        {/* Konten Branding */}
        <div className="relative z-10 flex h-full flex-col justify-between p-12">
          <div>
            <div className="flex items-center gap-3">
              <div className="flex h-10 w-10 items-center justify-center rounded-lg bg-primary text-white shadow-lg shadow-primary/20">
                <FontAwesomeIcon icon={faBookOpen} />
              </div>
              <span className="text-xl font-bold tracking-wide text-white font-display">HalaqahId</span>
            </div>
          </div>

          <div className="max-w-lg">
            <h2 className="mb-4 text-4xl font-bold leading-tight text-white font-display">
              "Recite: In the name of thy Lord who created..."
            </h2>
            <p className="text-lg font-light leading-relaxed text-gray-200">
              Kelola santri, pantau hafalan, dan organisir halaqah Anda dengan lebih efisien dan terstruktur.
            </p>
          </div>

          {/* Stepper Indikator (Dekoratif) */}
          <div className="flex gap-2">
            <div className="h-1.5 w-10 rounded-full bg-primary" />
            <div className="h-1.5 w-3 rounded-full bg-white/30" />
            <div className="h-1.5 w-3 rounded-full bg-white/30" />
          </div>
        </div>
      </div>

      {/* --- Bagian Kanan: Form Login --- */}
      <div className="relative flex w-full flex-col items-center justify-center bg-surface-light p-6 dark:bg-background-dark lg:w-1/2">
        
        {/* Mobile Header Logo (Hanya muncul di layar kecil) */}
        <div className="absolute left-8 top-8 flex items-center gap-2 lg:hidden">
          <div className="flex h-9 w-9 items-center justify-center rounded-lg bg-primary text-white">
            <FontAwesomeIcon icon={faBookOpen} className="text-lg" />
          </div>
          <span className="text-xl font-bold dark:text-white font-display">HalaqahId</span>
        </div>

        <div className="mx-auto w-full max-w-md space-y-8">
          {/* Header Teks */}
          <div className="space-y-2 text-center lg:text-left">
            <h2 className="text-3xl font-bold tracking-tight text-text-primary-light dark:text-text-primary-dark font-display">
              Assalamu'alaikum, Ahlan Wa Sahlan
            </h2>
            <p className="text-base text-text-secondary-light dark:text-text-secondary-dark">
              Silakan masuk untuk mengakses Dashboard Halaqah Anda.
            </p>
          </div>

          {/* Pemanggilan Komponen LoginForm */}
          <div className="mt-8">
            <LoginForm />
          </div>

          {/* Footer Form */}
          <div className="text-center">
            <p className="text-sm text-text-secondary-light dark:text-gray-400">
              Belum memiliki akun?{" "}
              <a href="#" className="font-semibold text-primary hover:text-primary-dark transition-colors">
                Daftarkan Lembaga
              </a>
            </p>
          </div>
        </div>

        {/* Footer Copyright */}
        <div className="absolute bottom-8 left-0 w-full text-center">
          <p className="text-xs text-text-secondary-light/60 dark:text-gray-600">
            ¬© 2026 Halaqah Management System. All rights reserved.
          </p>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./pages/kepala-muhafidz/index.tsx ---

export default function MuhafidzPage() {
  return (
    <div className="space-y-6">
      <header className="text-left">
        <h2 className="text-2xl font-bold dark:text-white">Absensi Hari Ini</h2>
        <p className="text-text-secondary dark:text-text-secondary-dark text-sm">
          Silakan tandai kehadiran santri untuk hari ini.
        </p>
      </header>

      <div className="rounded-xl border border-border bg-surface p-6 dark:bg-surface-dark shadow-sm min-h-[400px]">
        {/* Konten tabel absensi akan kita buat di sini */}
        <div className="flex flex-col items-center justify-center h-full py-20 text-center">
           <div className="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-4">
              <span className="text-primary text-2xl">üìù</span>
           </div>
           <p className="text-text-secondary dark:text-text-secondary-dark font-medium">
             Siap memproses data absensi...
           </p>
        </div>
      </div>
    </div>
  );
}

--- FILE: ./services/authService.ts ---

import axiosClient from "@/api/axiosClient";
import { type LoginFormValues } from "@/utils/zodSchema";

// Interface respons dari backend (disesuaikan dengan skema Prisma)
export interface AuthResponse {
  success: boolean;
  message: string;
  data: { 
    user: {
      id_user: number;
      email: string;
      role: "superadmin" | "muhafidz";
      nama?: string;
    };
    token: string;
  };
}

export const authService = {
  login: async (credentials: LoginFormValues): Promise<AuthResponse> => {
    // Endpoint: /auth/login
    const response = await axiosClient.post<AuthResponse>("/auth/login", credentials);
    return response.data;
  },

  getCurrentUser: async (): Promise<AuthResponse> => {
    // Endpoint: /auth/me
    const response = await axiosClient.get<AuthResponse>("/auth/me");
    return response.data;
  },

  logout: () => {
    localStorage.removeItem("user");
  }
};

--- FILE: ./App.tsx ---

import { BrowserRouter } from "react-router-dom";
import { AuthProvider } from "@/context/AuthContext";
import { AppRouter } from "@/routes";
import "./App.css";

function App() {
  return (
    <BrowserRouter>
      <AuthProvider>
        <AppRouter />
      </AuthProvider>
    </BrowserRouter>
  );
}

export default App;

--- FILE: ./context/AuthContext.tsx ---

import React, { createContext, useContext, useState, useEffect, useCallback } from "react";
import { type LoginFormValues } from "@/utils/zodSchema";
import { authService } from "@/services/authService";

export type Role = "superadmin" | "muhafidz";

interface User {
  id_user: number;
  email: string;
  role: Role;
  nama: string;
}

interface AuthContextType {
  user: User | null;
  login: (values: LoginFormValues) => Promise<void>;
  logout: () => void;
  isLoading: boolean;
  isDarkMode: boolean;
  toggleDarkMode: () => void;
  refreshUser: () => Promise<void>;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export const AuthProvider = ({ children }: { children: React.ReactNode }) => {
  const [user, setUser] = useState<User | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [isDarkMode, setIsDarkMode] = useState(false);

  // Gunakan useCallback agar bisa dipanggil di useEffect tanpa re-render loop
  const refreshUser = useCallback(async () => {
    const savedData = localStorage.getItem("user");
    if (!savedData) {
      setIsLoading(false);
      return;
    }

    try {
      const response = await authService.getCurrentUser();
      // Dokumentasi: API return { success: true, data: { user: {...} } }
      const userData = response.data.user; 
      const { token } = JSON.parse(savedData);

      const fullData = { ...userData, token };
      setUser(fullData as any);
      localStorage.setItem("user", JSON.stringify(fullData));
    } catch (error) {
      console.error("Session invalid:", error);
      logout();
    } finally {
      setIsLoading(false);
    }
  }, []);

  // 1. Gabungkan Inisialisasi (Theme & Auth) dalam satu useEffect
  useEffect(() => {
    // Inisialisasi Theme
    const savedTheme = localStorage.getItem("theme");
    const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
    if (savedTheme === "dark" || (!savedTheme && prefersDark)) {
      setIsDarkMode(true);
      document.documentElement.classList.add("dark");
    }

    // Inisialisasi Auth
    refreshUser();
  }, [refreshUser]);

  const login = async (values: LoginFormValues) => {
    setIsLoading(true);
    try {
      const response = await authService.login(values);
      
      // Sesuai dokumentasi: response.data.user dan response.data.token
      const userData = {
        ...response.data.user,
        token: response.data.token
      };

      setUser(userData as any);
      localStorage.setItem("user", JSON.stringify(userData));
    } catch (error) {
      throw error; // Biarkan LoginForm yang menangani pesan errornya
    } finally {
      setIsLoading(false);
    }
  };
  
  const logout = () => {
    setUser(null);
    localStorage.removeItem("user");
  };

  const toggleDarkMode = () => {
    const newDarkMode = !isDarkMode;
    setIsDarkMode(newDarkMode);
    if (newDarkMode) {
      document.documentElement.classList.add("dark");
      localStorage.setItem("theme", "dark");
    } else {
      document.documentElement.classList.remove("dark");
      localStorage.setItem("theme", "light");
    }
  };

  return (
    <AuthContext.Provider value={{ 
      user, 
      login, 
      logout, 
      isLoading,
      isDarkMode,
      toggleDarkMode,
      refreshUser
    }}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (!context) throw new Error("useAuth must be used within AuthProvider");
  return context;
};

--- FILE: ./lib/utils.ts ---

import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}


--- FILE: ./routes/index.tsx ---

import { Routes, Route, Navigate, useLocation, Outlet } from "react-router-dom";
import LoginPage from "@/pages/auth/LoginPage";
// import KepalaMuhafidzPage from "@/pages/kepala-muhafidz"; 
import MuhafidzPage from "@/pages/muhafidz"; 
import { useAuth } from "@/context/AuthContext";
import DashboardLayout from "@/layouts/DashboardLayout";
import { useEffect } from "react";

//Memanggil refreshUser (/me) setiap pindah halaman.
const ProtectedRoute = ({ allowedRoles }: { allowedRoles?: ("superadmin" | "muhafidz")[] }) => {
  const { user, isLoading, refreshUser } = useAuth();
  const location = useLocation();

  useEffect(() => {
    // Selalu validasi token ke backend setiap kali pindah URL
    const checkTokenRealtime = async () => {
      if (localStorage.getItem("user")) {
        await refreshUser();
      }
    };
    checkTokenRealtime();
  }, [location.pathname, refreshUser]);

  if (isLoading) {
    // Bisa diganti dengan Spinner Component yang lebih bagus
    return (
      <div className="flex h-screen w-full items-center justify-center bg-background">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div>
      </div>
    );
  }

  // Jika tidak ada user (atau token habis setelah refreshUser gagal), tendang ke login
  if (!user) {
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  // Jika role tidak diizinkan, kembalikan ke root (yang nanti akan me-redirect ke dashboard masing-masing)
  if (allowedRoles && !allowedRoles.includes(user.role)) {
    return <Navigate to="/" replace />; 
  }

  return <Outlet />;
};

export const AppRouter = () => {
  const { user } = useAuth();

  return (
    <Routes>
      {/* üîì Public Route: Login */}
      <Route 
        path="/login" 
        element={user ? <Navigate to="/" replace /> : <LoginPage />} 
      />

      {/* üîí Protected Routes: Membutuhkan Login */}
      <Route element={<ProtectedRoute />}>
        <Route element={<DashboardLayout />}>
          
          {/* 1. Entry Point: Redirect berdasarkan role */}
          <Route
            path="/"
            element={
              user?.role === "superadmin" ? (
                <Navigate to="/kepala-muhafidz" replace />
              ) : (
                <Navigate to="/muhafidz" replace />
              )
            }
          />

          {/* 2. Rute Khusus Superadmin (Kepala Muhafidz) */}
          <Route element={<ProtectedRoute allowedRoles={["superadmin"]} />}>
            <Route path="/kepala-muhafidz/*" element={<MuhafidzPage />} />
          </Route>

          {/* 3. Rute Khusus Muhafidz */}
          <Route element={<ProtectedRoute allowedRoles={["muhafidz"]} />}>
            <Route path="/muhafidz/*" element={<MuhafidzPage />} />
          </Route>

        </Route>
      </Route>

      {/* 404 Fallback */}
      <Route path="*" element={<Navigate to="/" replace />} />
    </Routes>
  );
};

--- FILE: ./utils/zodSchema.ts ---

import * as z from "zod";

export const loginSchema = z.object({
  email: z.string().email("Format email tidak valid"),
  password: z.string().min(8, "Password minimal 8 karakter"),
});

export const setoranSchema = z.object({
  santri_id: z.coerce.number().min(1, "Pilih santri"),
  tanggal: z.date(),
  surah: z.string().min(1, "Nama surah wajib diisi"),
  ayat_mulai: z.coerce.number().min(1, "Minimal ayat 1"),
  ayat_selesai: z.coerce.number().min(1, "Minimal ayat 1"),
  nilai: z.coerce.number().min(0).max(100),
  catatan: z.string().default(""), 
});

export type LoginFormValues = z.infer<typeof loginSchema>;
export type SetoranFormValues = z.infer<typeof setoranSchema>;

--- FILE: ./App.css ---

/* @import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

#root {
  max-width: 1280px;
  margin: 0 auto;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
} */


--- FILE: ./index.css ---

@import "tailwindcss";
@import "tw-animate-css";

/* Theme Configuration */
@theme {
  /* Colors */
  --color-primary: #45cf17;
  --color-primary-dark: #36a312;
  --color-primary-foreground: #ffffff;
  
  --color-background: #f6f8f6;
  --color-background-dark: #152111;
  
  --color-surface: #ffffff;
  --color-surface-dark: #1e2e19;
  
  --color-foreground: #111b0e;
  --color-foreground-dark: #f0fdf4;
  
  --color-text-primary: #111b0e;
  --color-text-primary-dark: #f0fdf4;
  
  --color-text-secondary: #60974e;
  --color-text-secondary-dark: #a3d9a5;
  
  --color-muted: #60974e;
  --color-muted-foreground: #60974e;
  
  --color-accent: #d6e7d0;
  --color-accent-foreground: #111b0e;
  
  --color-destructive: #ef4444;
  --color-destructive-foreground: #ffffff;
  
  --color-border: #d6e7d0;
  --color-border-dark: #2d4425;
  
  --color-input: #ffffff;
  --color-input-dark: #2d4425;
  
  --color-ring: #45cf17;
  
  /* Border Radius */
  --radius: 0.625rem;
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  
  /* Font */
  --font-display: "Lexend", sans-serif;
}

/* Custom Variant untuk Dark Mode */
@custom-variant dark (&:is(.dark *));

/* CSS Variables untuk Light Mode */
:root {
  --background: var(--color-background);
  --foreground: var(--color-foreground);
  --primary: var(--color-primary);
  --primary-foreground: var(--color-primary-foreground);
  --secondary: var(--color-text-secondary);
  --secondary-foreground: var(--color-foreground);
  --muted: var(--color-muted);
  --muted-foreground: var(--color-muted-foreground);
  --accent: var(--color-accent);
  --accent-foreground: var(--color-accent-foreground);
  --destructive: var(--color-destructive);
  --destructive-foreground: var(--color-destructive-foreground);
  --border: var(--color-border);
  --input: var(--color-input);
  --ring: var(--color-ring);
  --card: var(--color-surface);
  --card-foreground: var(--color-text-primary);
  --popover: var(--color-surface);
  --popover-foreground: var(--color-text-primary);
}

/* CSS Variables untuk Dark Mode */
.dark {
  --background: var(--color-background-dark);
  --foreground: var(--color-foreground-dark);
  --primary: var(--color-primary);
  --primary-foreground: var(--color-primary-foreground);
  --secondary: var(--color-text-secondary-dark);
  --secondary-foreground: var(--color-foreground-dark);
  --muted: var(--color-text-secondary-dark);
  --muted-foreground: var(--color-text-secondary-dark);
  --accent: var(--color-surface-dark);
  --accent-foreground: var(--color-text-primary-dark);
  --destructive: var(--color-destructive);
  --destructive-foreground: var(--color-destructive-foreground);
  --border: var(--color-border-dark);
  --input: var(--color-input-dark);
  --ring: var(--color-ring);
  --card: var(--color-surface-dark);
  --card-foreground: var(--color-text-primary-dark);
  --popover: var(--color-surface-dark);
  --popover-foreground: var(--color-text-primary-dark);
}

/* Base Styles */
@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  
  body {
    @apply bg-background text-foreground font-display;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
  
  html {
    scroll-behavior: smooth;
  }
}

/* Utility Classes */
@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* Font Import */
@import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap');


